{% extends "template.html" %}
{% block title %}Search{% endblock title %}
{% block pageTitle %}Search{% endblock pageTitle %}
{% block head %}
 
<link rel="stylesheet" href="{{ url_for('static', filename='css/highcharts_custom.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/favorite_button.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/skeleton.css') }}">
{% endblock head %}

{% block flex_1 %}hidden{% endblock flex_1 %}

{% block search_body %}
<div class="flex flex-row flex-wrap items-center px-4 sm:px-16 mt-24 justify-center w-screen gap-3">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="w-full mx-auto my-3">
        {% for category, message in messages %}
          {% if category == 'success' %}
          <div class="alert mt-3 bg-success/[0.625] shadow-lg">
            <div>
              <svg xmlns="http://www.w3.org/2000/svg" class="stroke-success-content flex-shrink-0 h-6 w-6" fill="none"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <span class="text-black">{{ message }}</span>
            </div>
          </div>
          {% elif category == 'error' %}
          <div class="alert mt-3 bg-error/[0.625] shadow-lg">
            <div>
              <svg xmlns="http://www.w3.org/2000/svg" class="stroke-error-content flex-shrink-0 h-6 w-6" fill="none"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <span class="text-black">{{ message }}</span>
            </div>
          </div>
          {% elif category == 'warning' %}
          <div class="alert mt-3 bg-warning/[0.625] shadow-lg">
            <div>
              <svg xmlns="http://www.w3.org/2000/svg" class="stroke-warning-content flex-shrink-0 h-6 w-6" fill="none"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
              </svg>
              <span class="text-black">{{ message }}</span>
            </div>
          </div>
          {% endif %}
        {% endfor %}
    </div>
    {% endif %}
  {% endwith %}
  <!-- <button class="btn rounded-md grow-0 search-appear border-0 hover:border-0 translate-y-3 hover:underline bg-transparent hover:bg-transparent" style="display: none">
    <a href="{{ url_for('search') }}">
      <i class="fa-solid fa-arrow-left"></i>
      Back
    </a>
  </button> 
  honestly this button is kinda sus, it's not really needed and it's not really used, so I'm just gonna comment it out for now
  --> 
  <form class="form-control grow order-0" role="search" action="" autocapitalize="characters"
    autocomplete="off" id="search-form">
    {{ searchForm.csrf_token }}
    <div class="text-5xl font-bold text-white whitespace-nowrap overflow-hidden  mb-2">
      <h1>Enter Stock Ticker:</h1>
    </div>
    <div class="input-group mb-3 flex">
      {% if searchForm.ticker.errors %}
      {{ searchForm.ticker(class="input input-bordered w-full bg-[#100e17]", id="ticker") }}
      {% for error in searchForm.ticker.errors %}
      <span class="invalid-feedback">{{ error }}</span>
      {% endfor %}
      {% else %}
      {{ searchForm.ticker(class="input input-bordered w-full bg-[#100e17]", id="ticker") }}
      {% endif %}
      <button class="btn btn-square" id="search-form-submit" name="submit" type="submit">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </button>
    </div>
    <div class="join join-vertical rounded-xl w-max bg-[#1e1a2b] hidden" id="autocomplete-results"></div>
  </form>
  {% if current_identity != '' %}
    <div class="grow-0 min-w-[125px] sm:-translate-y-2 max-sm:-translate-y-1 search-appear " style="display: none">
      <button class="favorite-button" id="favorite-button">
        <div class="icon">
            <div class="star"></div>
        </div>
        <span>Watchlist</span>
      </button>
    </div>
  {% endif %}
</div>
<div style="display: none;" id="search-results" class="">
  <div class="grid place-content-center w-screen" id="overview">
    <div class="mt-10 bg-gradient-to-r w-screen px-16 text-white justify-center from-purple-100/[0.1] to-purple-400/[0.1] ">
      <div class="flex flex-row justify-around">
        <h1 class="text-5xl font-bold m-4 w-max break-none" id="ticker-heading"></h1>
        <h1 class="text-sm font-medium m-4 text-slate-300" id="ticker-description"></h1>
      </div>
      <div class="flex flex-row flex-wrap justify-left text-left gap-x-6 border-t-2 border-white/25 m-6 pt-3">
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">Open:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="open-val"></span>
        </div>
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">Close:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="close-val"></span>
        </div>
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">High:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="high-val"></span>
        </div>
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">Low:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="low-val"></span>
        </div>
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">52W High:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="long-high"></span>
        </div>
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">52W Low:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="long-low"></span>
        </div>
        <div class="flex flex-row flex-nowrap gap-x-2">
          <span class="font-semibold text-xl">Volume:</span>
          <span class="font-normal text-xl text-white/[0.85]" id="volume-val"></span>
        </div>
      </div>
    </div>
  </div>
  <div class="grid mt-10 grid-cols-12 px-4 sm:px-16">
    <div class="col-span-12 lg:col-span-7 md:mx-5">
      <div class="min-h-[50vh] rounded-lg drop-shadow-lg skeleton" id="candle_div"></div>
      <div class="w-6 w-12 h-6 h-4 h-3 h-2 w-[60vw] skeleton lg:outline lg:outline-offset-2 lg:outline-2 w-16 w-24 w-32 lg:outline-pink-600/50 hidden"></div> <!-- this element is for styles that js dynamically adds which main.css won't load otherwise -->
    </div>
    <div class="col-span-12 lg:col-span-3 lg:col-start-9 lg:grid lg:place-content-center" id="finance-analysis">
      <div>
        <div class="divider my-10">
          <h1 class="text-5xl font-bold text-white text-center">Financial Analysis</h1>
        </div>
        <div class="flex flex-row items-center self-stretch h-4 whitespace-nowrap mt-12 text-center justify-center text-xl">
          <h3 class="text-sm text-center">\[P/E=\frac{\text{Share price}}{\text{Earnings per share}}={  }\]</h3>
          <span id="pe-ratio" class="w-12">
            <div class="skeleton w-full h-4 mb-1 rounded-sm last:w-4/5 last:mb-0"></div>
          </span>
        </div>
        <div class="flex flex-row relative items-center place-content-center self-stretch h-4 whitespace-nowrap mt-6 mb-12 text-center justify-center text-xl">
          <input disabled class="bg-gradient-to-r w-1/2 from-green-500 via-yellow-500 to-red-500" type="range" min="1" max="100" id="scoreSlider"></input>
        </div>
        <div class="flex flex-row items-center self-stretch h-4 whitespace-nowrap my-12 text-center justify-center text-xl">
          <h3 class="text-sm text-center">\[EPS=\frac{\text{Net income}-\text{Dividends on preferred stock}}{\text{Average outstanding common shares}}={  }</span>\]</h3>
          <span id="eps-ratio" class="w-12">
            <div class="skeleton w-full h-4 mb-1 rounded-sm last:w-4/5 last:mb-0"></div>
          </span>
        </div>
        <div class="flex flex-row items-center self-stretch h-4 whitespace-nowrap my-12 text-center justify-center text-xl">
          <h3 class="text-sm text-center">\[\text{Composite Score}=\frac{\text{Earnings before Interest and Taxes}}{\text{Net Fixed Assets}-\text{Working Capital}}={  }\]</h3>
          <span id="composite-score" class="w-12">
            <div class="skeleton w-full h-4 mb-1 rounded-sm last:w-4/5 last:mb-0"></div>
          </span>
        </div>
        <!-- <div class="flex flex-row items-center self-stretch h-4 whitespace-nowrap text-xl">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="white" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
          </svg>
        </div> -->
      </div>
    </div>
  </div>

  <div class="divider mt-20 mb-10" id="news-header">
    <h1 class="text-5xl font-bold text-white text-center">News</h1>
  </div>  

  <div class="hidden px-6 py-3 pt-4 -translate-x-4 translate-x-10 h-2 h-4 w-64 invisible text-red-500 text-green-500 text-end h-full px-6 max-sm:hover:shadow-xl justify-between max-sm:hover:drop-shadow-xl gap-x-24 max-sm:hover:-translate-y-[10%] sm:shadow-[-1rem_0_3rem_#000]  transition-all duration-700 rounded-lg overflow-hidden relative text-white flex flex-col w-96 group left-0 sm:[&:not(:first-child)]:ml-[-100px] stack-card shrink-0 grow mr-6 ml-6"></div> <!-- for main.css -->

  <div class="h-max w-screen grid grid-flow-col auto-rows-min overflow-x-scroll px-12 pt-24 pb-12 -mt-24 overflow-y-visible mb-12 scrollbar minimalist taller items-stretch content-stretch " id="news">
    <div class="hidden h-full max-sm:hover:shadow-xl max-sm:hover:drop-shadow-xl max-sm:hover:-translate-y-[10%] sm:shadow-[-1rem_0_3rem_#000]  transition-all duration-700 rounded-lg overflow-hidden relative text-white flex flex-col w-96 group left-0 sm:[&:not(:first-child)]:ml-[-100px] stack-card shrink-0 grow">
      <figure class="grow overflow-hidden"><a href="finance.yahoo.com" target="_blank" class="grow"><img src="https://placebeard.it/880x660" class="grow w-full h-full object-cover group-hover:scale-110 transition-all brightness-[0.6] group-hover:brightness-100 duration-700 rounded-t-lg skeleton"></a></figure>
      <a href="finance.yahoo.com" target="_blank">
        <div class="py-4 h-max overflow-visible bg-[#1b1726] grow-0">
          <h2 class="px-6 text-2xl font-semibold hover:underline mb-2">Breaking News: AAPL is Overpriced more word ax Overpriced</h2>
          <h3 class="px-6 text-slate-500 text-sm mb-4">— Me</h3>
          <div class="bar w-full relative h-1.5  overflow-hidden bg-white/25 mb-4">
            <div class="w-0 h-full absolute top-0 left-0 bg-gradient-to-r from-pink-500 via-purple-500 to-pink-500 transition-all duration-700 hover:w-full group-hover:w-full"></div>
          </div>
          <div class="px-2 flex flex-wrap flex-row justify-center items-center gap-x-4 gap-y-2">
            <a class="flex justify-center items-center text-white text-base font-medium hover:bg-white/[0.075] bg-transparent border-2 border-white/25 hover:border-transparent rounded-full min-w-64 h-8 p-4 px-2 mb-2 text-center" href="https://www.apple.com/">
              <span class="text-center">AAPL</span>
            </a>
            <a class="flex justify-center items-center text-white text-base font-medium hover:bg-white/[0.075] bg-transparent border-2 border-white/25 hover:border-transparent rounded-full min-w-64 h-8 p-4 px-2 mb-2 text-center" href="https://www.microsoft.com/">
              <span class="text-center">MSFT</span>
            </a>
            <a class="flex justify-center items-center text-white text-base font-medium hover:bg-white/[0.075] bg-transparent border-2 border-white/25 hover:border-transparent rounded-full min-w-64 h-8 p-4 px-2 mb-2 text-center" href="https://www.tesla.com/">
              <span class="text-center">TSLA</span>
            </a>
            <a class="flex justify-center items-center text-white text-base font-medium hover:bg-white/[0.075] bg-transparent border-2 border-white/25 hover:border-transparent rounded-full min-w-64 h-8 p-4 px-2 mb-2 text-center" href="https://www.apple.com/">
              <span class="text-center">AAPL</span>
            </a>
          </div>
        </div>
      </a>
    </div>
  </div>
  <div class="divider my-10 hidden" id="insider-heading">
    <h1 class="text-5xl font-bold text-white text-center">Institutional Transactions</h1>
  </div>  
  <div class="flex flex-col gap-y-10 md:gap-x-10 md:flex-row mb-10 md:flex-wrap justify-center hidden" id="insider-trading"></div>

  <div id="tweets-container">
    <div class="divider my-10" id="tweets-heading">
      <h1 class="text-5xl font-bold text-white text-center">Tweets</h1>
    </div>  
    <div class="flex flex-col gap-y-10 md:gap-x-10 md:flex-row mb-10 md:flex-wrap justify-center" id="tweets"></div>
    <div class="flex flex-col gap-y-10 md:gap-x-10 md:flex-row mb-10 md:flex-wrap justify-center text-2xl font-bold" id="sentiment-score"></div>
    <div class="flex flex-row relative items-center self-stretch h-4 whitespace-nowrap mt-6 mb-12 text-center justify-center text-xl">
      <input disabled class="bg-gradient-to-r w-1/2 from-red-500 via-yellow-500 to-green-500" type="range" min="1" max="100" id="sentimentSlider"></input>
    </div>
  </div>
</div>
{{super()}}
{% endblock search_body %}

{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
<script src="{{ url_for('static', filename='js/star_button.js') }}"></script>
<script src="{{ url_for('static', filename='js/f_stocks.js') }}"></script>
<script src="{{ url_for('static', filename='js/search.js') }}"></script>

<!-- Highcharts CDNs -->
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/highcharts-3d.js"></script>
<script src="https://code.highcharts.com/modules/stock.js"></script>
<script src="https://code.highcharts.com/maps/modules/map.js"></script>
<script src="https://code.highcharts.com/modules/gantt.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/parallel-coordinates.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<script src="https://code.highcharts.com/modules/annotations-advanced.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/draggable-points.js"></script>
<script src="https://code.highcharts.com/modules/static-scale.js"></script>
<script src="https://code.highcharts.com/modules/broken-axis.js"></script>
<script src="https://code.highcharts.com/modules/heatmap.js"></script>
<script src="https://code.highcharts.com/modules/tilemap.js"></script>
<script src="https://code.highcharts.com/modules/timeline.js"></script>
<script src="https://code.highcharts.com/modules/treemap.js"></script>
<script src="https://code.highcharts.com/modules/treegraph.js"></script>
<script src="https://code.highcharts.com/modules/item-series.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>
<script src="https://code.highcharts.com/modules/histogram-bellcurve.js"></script>
<script src="https://code.highcharts.com/modules/bullet.js"></script>
<script src="https://code.highcharts.com/modules/funnel.js"></script>
<script src="https://code.highcharts.com/modules/funnel3d.js"></script>
<script src="https://code.highcharts.com/modules/pyramid3d.js"></script>
<script src="https://code.highcharts.com/modules/networkgraph.js"></script>
<script src="https://code.highcharts.com/modules/pareto.js"></script>
<script src="https://code.highcharts.com/modules/pattern-fill.js"></script>
<script src="https://code.highcharts.com/modules/price-indicator.js"></script>
<script src="https://code.highcharts.com/modules/sankey.js"></script>
<script src="https://code.highcharts.com/modules/arc-diagram.js"></script>
<script src="https://code.highcharts.com/modules/dependency-wheel.js"></script>
<script src="https://code.highcharts.com/modules/series-label.js"></script>
<script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
<script src="https://code.highcharts.com/modules/sonification.js"></script>
<script src="https://code.highcharts.com/modules/stock-tools.js"></script>
<script src="https://code.highcharts.com/modules/streamgraph.js"></script>
<script src="https://code.highcharts.com/modules/sunburst.js"></script>
<script src="https://code.highcharts.com/modules/variable-pie.js"></script>
<script src="https://code.highcharts.com/modules/variwide.js"></script>
<script src="https://code.highcharts.com/modules/vector.js"></script>
<script src="https://code.highcharts.com/modules/venn.js"></script>
<script src="https://code.highcharts.com/modules/windbarb.js"></script>
<script src="https://code.highcharts.com/modules/wordcloud.js"></script>
<script src="https://code.highcharts.com/modules/xrange.js"></script>
<script src="https://code.highcharts.com/modules/no-data-to-display.js"></script>
<script src="https://code.highcharts.com/modules/drag-panes.js"></script>
<script src="https://code.highcharts.com/modules/debugger.js"></script>
<script src="https://code.highcharts.com/modules/dumbbell.js"></script>
<script src="https://code.highcharts.com/modules/lollipop.js"></script>
<script src="https://code.highcharts.com/modules/cylinder.js"></script>
<script src="https://code.highcharts.com/modules/organization.js"></script>
<script src="https://code.highcharts.com/modules/dotplot.js"></script>
<script src="https://code.highcharts.com/modules/marker-clusters.js"></script>
<script src="https://code.highcharts.com/modules/hollowcandlestick.js"></script>
<script src="https://code.highcharts.com/modules/heikinashi.js"></script>
{% endblock script %}


{% block footerClass %}fixed-bottom{% endblock footerClass %}